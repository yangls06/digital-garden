<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Docker进阶：step by step  Docker 微服务教程
一、预备工作：image 仓库的镜像网址 本教程需要从仓库下载 image 文件，但是国内访问 Docker 的官方仓库很慢，还经常断线，所以要把仓库网址改成国内的镜像站。这里推荐使用官方镜像 registry.docker-cn.com 。下面是我的 Debian 系统的默认仓库修改方法，其他系统的修改方法参考 官方文档。
打开/etc/default/docker文件（需要sudo权限），在文件的底部加上一行。
1  DOCKER_OPTS=&#34;--registry-mirror=https://registry."><title>Docker入门教程</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://yangls06.github.io/digital-garden//icon.png><link href=https://yangls06.github.io/digital-garden/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=https://yangls06.github.io/digital-garden/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://yangls06.github.io/digital-garden/js/darkmode.aa0630d04550405b827df945275af6c3.min.js></script>
<script src=https://yangls06.github.io/digital-garden/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://yangls06.github.io/digital-garden/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://yangls06.github.io/digital-garden/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://yangls06.github.io/digital-garden/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://yangls06.github.io/digital-garden/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://yangls06.github.io/digital-garden/",fetchData=Promise.all([fetch("https://yangls06.github.io/digital-garden/indices/linkIndex.7c72417e07be9f92dd43a61d3c1ab189.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://yangls06.github.io/digital-garden/indices/contentIndex.3c196654adb12e831d4bcd12ec9b1753.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://yangls06.github.io/digital-garden",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://yangls06.github.io/digital-garden",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/yangls06.github.io\/digital-garden\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-GQ32FS7YEX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GQ32FS7YEX",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://yangls06.github.io/digital-garden/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://yangls06.github.io/digital-garden/>🪴 无人之路</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Docker入门教程</h1><p class=meta>Last updated
Dec 14, 2022
<a href=https://github.com/yangls06/digital-garden/tree/hugo/content/notes/hands-on-docker_2.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://yangls06.github.io/digital-garden/tags/docker/>Docker</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><ol><li><a href=#一预备工作image-仓库的镜像网址>一、预备工作：image 仓库的镜像网址</a></li><li><a href=#二方法-a自建-wordpress-容器>二、方法 A：自建 WordPress 容器</a></li><li><a href=#三方法-bwordpress-官方镜像>三、方法 B：Wordpress 官方镜像</a></li><li><a href=#四方法-cdocker-compose-工具>四、方法 C：Docker Compose 工具</a></li><li><a href=#五参考链接>五、参考链接</a></li></ol></li></ol></nav></details></aside><a href=#docker进阶step-by-step><h1 id=docker进阶step-by-step><span class=hanchor arialabel=Anchor># </span>Docker进阶：step by step</h1></a><p><a href=https://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html rel=noopener>Docker 微服务教程</a></p><a href=#一预备工作image-仓库的镜像网址><h3 id=一预备工作image-仓库的镜像网址><span class=hanchor arialabel=Anchor># </span>一、预备工作：image 仓库的镜像网址</h3></a><p>本教程需要从仓库下载 image 文件，但是国内访问 Docker 的官方仓库很慢，还经常断线，所以要把仓库网址改成国内的镜像站。这里推荐使用官方镜像 registry.docker-cn.com 。下面是我的 Debian 系统的默认仓库修改方法，其他系统的修改方法参考
<a href=https://www.docker-cn.com/registry-mirror rel=noopener>官方文档</a>。</p><p>打开<code>/etc/default/docker</code>文件（需要<code>sudo</code>权限），在文件的底部加上一行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl><span class=nv>DOCKER_OPTS</span><span class=o>=</span><span class=s2>&#34;--registry-mirror=https://registry.docker-cn.com&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>然后，重启 Docker 服务。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>$ sudo service docker restart
</span></span></code></pre></td></tr></table></div></div><p>现在就会自动从镜像仓库下载 image 文件了。</p><a href=#二方法-a自建-wordpress-容器><h3 id=二方法-a自建-wordpress-容器><span class=hanchor arialabel=Anchor># </span>二、方法 A：自建 WordPress 容器</h3></a><p>前面说过，本文会用三种方法演示 WordPress 的安装。第一种方法就是自建 WordPress 容器。</p><a href=#21-官方-的-php-image><h4 id=21-官方-的-php-image><span class=hanchor arialabel=Anchor># </span>2.1 官方 的 PHP image</h4></a><p>首先，新建一个工作目录，并进入该目录。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>$ mkdir docker-demo <span class=o>&amp;&amp;</span> <span class=nb>cd</span> docker-demo
</span></span></code></pre></td></tr></table></div></div><p>然后，执行下面的命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container run <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --rm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --name wordpress <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --volume <span class=s2>&#34;</span><span class=nv>$PWD</span><span class=s2>/&#34;</span>:/var/www/html <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  php:5.6-apache
</span></span></code></pre></td></tr></table></div></div><p>上面的命令基于<code>php</code>的 image 文件新建一个容器，并且运行该容器。<code>php</code>的标签是<code>5.6-apache</code>，说明装的是 PHP 5.6，并且自带 Apache 服务器。该命令的三个参数含义如下。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>--rm：停止运行后，自动删除容器文件。
</span></span><span class=line><span class=cl>--name wordpress：容器的名字叫做wordpress。
</span></span><span class=line><span class=cl>--volume <span class=s2>&#34;</span><span class=nv>$PWD</span><span class=s2>/&#34;</span>:/var/www/html：将当前目录（<span class=nv>$PWD</span>）映射到容器的/var/www/html（Apache 对外访问的默认目录）。因此，当前目录的任何修改，都会反映到容器里面，进而被外部访问到。
</span></span></code></pre></td></tr></table></div></div><p>运行上面的命令以后，如果一切正常，命令行会提示容器对外的 IP 地址，请记下这个地址，我们要用它来访问容器。我分配到的 IP 地址是 172.17.0.2。</p><p>打开浏览器，访问 172.17.0.2，你会看到下面的提示。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>Forbidden
</span></span><span class=line><span class=cl>You don<span class=err>&#39;</span>t have permission to access / on this server.
</span></span></code></pre></td></tr></table></div></div><p>是因为容器的<code>/var/www/html</code>目录（也就是本机的<code>docker-demo</code>目录）下面什么也没有，无法提供可以访问的内容。</p><p>请在本机的<code>docker-demo</code>目录下面，添加一个最简单的 PHP 文件<code>index.php</code>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>&lt;?php 
</span></span><span class=line><span class=cl>phpinfo<span class=o>()</span><span class=p>;</span>
</span></span><span class=line><span class=cl>?&gt;
</span></span></code></pre></td></tr></table></div></div><p>保存以后，浏览器刷新<code>172.17.0.2</code>，应该就会看到熟悉的<code>phpinfo</code>页面了。</p><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=MTE1MTExN2M2NjUzYTQzYjIyNmZhMmUxMDRmMGQwYzZfMUdteFNRN2NnaHBERTZVdDQzYVFKbkxKT29QQmZybWtfVG9rZW46Ym94Y25uV2xkc2J6SDJhd0hGaTlhU25BbE5oXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><a href=#22-拷贝-wordpress-安装包><h4 id=22-拷贝-wordpress-安装包><span class=hanchor arialabel=Anchor># </span>2.2 拷贝 WordPress 安装包</h4></a><p>既然本地的<code>docker-demo</code>目录可以映射到容器里面，那么把 WordPress 安装包拷贝到<code>docker-demo</code>目录下，不就可以通过容器访问到 WordPress 的安装界面了吗？</p><p>首先，在<code>docker-demo</code>目录下，执行下面的命令，抓取并解压 WordPress 安装包。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>wget https://cn.wordpress.org/wordpress-4.9.4-zh_CN.tar.gz
</span></span><span class=line><span class=cl>tar -xvf wordpress-4.9.4-zh_CN.tar.gz
</span></span></code></pre></td></tr></table></div></div><p>解压以后，WordPress 的安装文件会在<code>docker-demo/wordpress</code>目录下。</p><p>这时浏览器访问<code>http://172.17.0.2/wordpress</code>，就能看到 WordPress 的安装提示了。</p><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=MDkxMGFmNzI3MjA2MWIxZmUyNTFjZTAyYWNkMzNkY2RfUlZOM2hEQTFHZkhwTlRHd0QzdGFmQTQxcklIaW9WUmhfVG9rZW46Ym94Y25DcU43NHE5SkM1TEF1UEJ2dE95eWdmXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><a href=#23-官方的-mysql-容器><h4 id=23-官方的-mysql-容器><span class=hanchor arialabel=Anchor># </span>2.3 官方的 MySQL 容器</h4></a><p>WordPress 必须有数据库才能安装，所以必须新建 MySQL 容器。</p><p>打开一个新的命令行窗口，执行下面的命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container run <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  -d <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  --rm <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  --name wordpressdb <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  --env <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=m>123456</span> <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  --env <span class=nv>MYSQL_DATABASE</span><span class=o>=</span>wordpress <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  mysql:5.7
</span></span></code></pre></td></tr></table></div></div><p>上面的命令会基于 MySQL 的 image 文件（5.7版本）新建一个容器。该命令的五个命令行参数的含义如下。</p><blockquote><ul><li><p><code>-d</code>：容器启动后，在后台运行。</p></li><li><p><code>--rm</code>：容器终止运行后，自动删除容器文件。</p></li><li><p><code>--name wordpressdb</code>：容器的名字叫做<code>wordpressdb</code></p></li><li><p><code>--env MYSQL_ROOT_PASSWORD=123456</code>：向容器进程传入一个环境变量<code>MYSQL_ROOT_PASSWORD</code>，该变量会被用作 MySQL 的根密码。</p></li><li><p><code>--env MYSQL_DATABASE=wordpress</code>：向容器进程传入一个环境变量<code>MYSQL_DATABASE</code>，容器里面的 MySQL 会根据该变量创建一个同名数据库（本例是<code>WordPress</code>）。</p></li></ul></blockquote><p>运行上面的命令以后，正常情况下，命令行会显示一行字符串，这是容器的 ID，表示已经新建成功了。</p><p>这时，使用下面的命令查看正在运行的容器，你应该看到<code>wordpress</code>和<code>wordpressdb</code>两个容器正在运行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container ls
</span></span><span class=line><span class=cl>CONTAINER ID   IMAGE            COMMAND                  CREATED          STATUS          PORTS                 NAMES
</span></span><span class=line><span class=cl>f01fe6ff7a31   mysql:5.7        <span class=s2>&#34;docker-entrypoint.s…&#34;</span>   <span class=m>15</span> seconds ago   Up <span class=m>13</span> seconds   3306/tcp, 33060/tcp   wordpressdb
</span></span><span class=line><span class=cl>b62e97351f5f   php:5.6-apache   <span class=s2>&#34;docker-php-entrypoi…&#34;</span>   <span class=m>32</span> seconds ago   Up <span class=m>30</span> seconds   80/tcp                wordpress
</span></span></code></pre></td></tr></table></div></div><p>其中，<code>wordpressdb</code>是后台运行的，前台看不见它的输出，必须使用下面的命令查看。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container logs wordpressdb
</span></span></code></pre></td></tr></table></div></div><a href=#24-定制-php-容器><h4 id=24-定制-php-容器><span class=hanchor arialabel=Anchor># </span>2.4 定制 PHP 容器</h4></a><p>现在 WordPress 容器和 MySQL 容器都已经有了。接下来，要把 WordPress 容器连接到 MySQL 容器了。但是，PHP 的官方 image 不带有<code>mysql</code>扩展，必须自己新建 image 文件。</p><p>首先，停掉 WordPress 容器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container stop wordpress
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 停掉之后</span>
</span></span><span class=line><span class=cl>docker container ls              
</span></span><span class=line><span class=cl>CONTAINER ID   IMAGE       COMMAND                  CREATED         STATUS         PORTS                 NAMES
</span></span><span class=line><span class=cl>f01fe6ff7a31   mysql:5.7   <span class=s2>&#34;docker-entrypoint.s…&#34;</span>   <span class=m>3</span> minutes ago   Up <span class=m>3</span> minutes   3306/tcp, 33060/tcp   wordpressdb
</span></span></code></pre></td></tr></table></div></div><p>停掉以后，由于<code>--rm</code>参数的作用，该容器文件会被自动删除。</p><p>然后，在<code>docker-demo</code>目录里面，新建一个<code>Dockerfile</code>文件，写入下面的内容。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>FROM php:5.6-apache
</span></span><span class=line><span class=cl>RUN docker-php-ext-install mysqli
</span></span><span class=line><span class=cl>CMD apache2-foreground
</span></span></code></pre></td></tr></table></div></div><p>上面代码的意思，就是在原来 PHP 的 image 基础上，安装<code>mysqli</code>的扩展。然后，启动 Apache。</p><p>基于这个 Dockerfile 文件，新建一个名为<code>phpwithmysql</code>的 image 文件。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker build -t phpwithmysql .
</span></span></code></pre></td></tr></table></div></div><a href=#25-wordpress-容器连接-mysql><h4 id=25-wordpress-容器连接-mysql><span class=hanchor arialabel=Anchor># </span>2.5 Wordpress 容器连接 MySQL</h4></a><p>现在基于 phpwithmysql image，重新新建一个 WordPress 容器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container run <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  --rm <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  --name wordpress <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  --volume <span class=s2>&#34;</span><span class=nv>$PWD</span><span class=s2>/&#34;</span>:/var/www/html <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --link wordpressdb:mysql <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  phpwithmysql
</span></span></code></pre></td></tr></table></div></div><p>跟上一次相比，上面的命令多了一个参数<code>--link wordpressdb:mysql</code>，表示 WordPress 容器要连到<code>wordpressdb</code>容器，冒号表示该容器的别名是<code>mysql</code>。</p><p>这时还要改一下<code>wordpress</code>目录的权限，让容器可以将配置信息写入这个目录（容器内部写入的<code>/var/www/html</code>目录，会映射到这个目录）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>chmod -R <span class=m>777</span> wordpress
</span></span></code></pre></td></tr></table></div></div><p>接着，回到浏览器的<code>http://172.17.0.2/wordpress</code>页面，点击"现在就开始！&ldquo;按钮，开始安装。</p><p>WordPress 提示要输入数据库参数。输入的参数如下。</p><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=MzEyYjA2NmVmMDE0NWU3N2ExZGU2ZjAyZWFmYTlhODVfd29RTHdycHluMURNUG9XZlZxS2FKTld4Nk1iZXk4a1dfVG9rZW46Ym94Y254YWVpSmRCM21qUElZZ0RIWmRpODVkXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><blockquote><ul><li><p>数据库名：<code>wordpress</code></p></li><li><p>用户名：<code>root</code></p></li><li><p>密码：<code>123456</code></p></li><li><p>数据库主机：<code>mysql</code></p></li><li><p>表前缀：<code>wp_</code>（不变）</p></li></ul></blockquote><p>点击"下一步"按钮，如果 Wordpress 连接数据库成功，就会出现下面的页面，这就表示可以安装了。</p><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=MDFjODhjOWEzZGJhNTc0MWJjMTI2ZmE1ZWM4ZTVlYTlfRnpyN2xadDJZMzJiSWszMlhWVk00NjV5dzZJYm1ZZjBfVG9rZW46Ym94Y25wbk1oZ3NieVNWVDlucWxHWFJRbGVlXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><p>至此，自建 WordPress 容器的演示完毕，可以把正在运行的两个容器关闭了（容器文件会自动删除）。</p><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=NTk1ZTQ1MDhiOTI4MTE1MzIzZjZlMTI3ODJjODAyZWVfSmRHcWdKc09oRDJXMElHZ0N1WWU5YzhKNk05STN4ODFfVG9rZW46Ym94Y255T2lCVWpmd2NOaFppQUlxZEtUYk5oXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><p>安装之后</p><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=MzkwYTg5NzQwMzJlYzAyZTNlNWI0MGI2MDBiYWZhZDZfWUdBd1VrV2tXNk4xc0RRNU5WeVB2M2hNbXJEYnJZcG1fVG9rZW46Ym94Y25tUExQRGUxMnp0dkI0WXhsbXJ6bU9oXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container stop wordpress wordpressdb
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 之后</span>
</span></span><span class=line><span class=cl>docker container ls
</span></span><span class=line><span class=cl>CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
</span></span></code></pre></td></tr></table></div></div><a href=#三方法-bwordpress-官方镜像><h3 id=三方法-bwordpress-官方镜像><span class=hanchor arialabel=Anchor># </span>三、方法 B：Wordpress 官方镜像</h3></a><p>上一部分的自建 WordPress 容器，还是挺麻烦的。其实不用这么麻烦，Docker 已经提供了官方
<a href=https://hub.docker.com/_/wordpress/ rel=noopener>WordPress</a> image，直接用那个就可以了。有了上一部分的基础，下面的操作就很容易理解了。</p><a href=#31-基本用法><h4 id=31-基本用法><span class=hanchor arialabel=Anchor># </span>3.1 基本用法</h4></a><p>首先，新建并启动 MySQL 容器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container run <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -d <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --rm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --name wordpressdb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --env <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=m>123456</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --env <span class=nv>MYSQL_DATABASE</span><span class=o>=</span>wordpress <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  mysql:5.7
</span></span></code></pre></td></tr></table></div></div><p>然后，基于官方的 WordPress image，新建并启动 WordPress 容器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container run <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -d <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --rm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --name wordpress <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --env <span class=nv>WORDPRESS_DB_PASSWORD</span><span class=o>=</span><span class=m>123456</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --env <span class=nv>WORDPRESS_DB_USER</span><span class=o>=</span>root <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --link wordpressdb:mysql <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  wordpress
</span></span></code></pre></td></tr></table></div></div><p>上面命令中，各个参数的含义前面都解释过了，其中环境变量<code>WORDPRESS_DB_PASSWORD</code>是 MySQL 容器的根密码。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container ls   
</span></span><span class=line><span class=cl>CONTAINER ID   IMAGE       COMMAND                  CREATED          STATUS          PORTS                 NAMES
</span></span><span class=line><span class=cl>ad6ee2dd4971   wordpress   <span class=s2>&#34;docker-entrypoint.s…&#34;</span>   <span class=m>48</span> seconds ago   Up <span class=m>35</span> seconds   80/tcp                wordpress
</span></span><span class=line><span class=cl>87f2d581abda   mysql:5.7   <span class=s2>&#34;docker-entrypoint.s…&#34;</span>   <span class=m>3</span> minutes ago    Up <span class=m>3</span> minutes    3306/tcp, 33060/tcp   wordpressdb
</span></span></code></pre></td></tr></table></div></div><p>上面命令指定<code>wordpress</code>容器在后台运行，导致前台看不见输出，使用下面的命令查出<code>wordpress</code>容器的 IP 地址。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container inspect wordpress
</span></span><span class=line><span class=cl><span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Id&#34;</span>: <span class=s2>&#34;ad6ee2dd497184a397c8bd58df7b415b5081bff5b0e000a10daa0b970b38cf9c&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Created&#34;</span>: <span class=s2>&#34;2022-08-26T02:16:36.222826772Z&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Path&#34;</span>: <span class=s2>&#34;docker-entrypoint.sh&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Args&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;apache2-foreground&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>,
</span></span><span class=line><span class=cl>   。。。
</span></span><span class=line><span class=cl>            <span class=s2>&#34;GlobalIPv6PrefixLen&#34;</span>: 0,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;IPAddress&#34;</span>: <span class=s2>&#34;172.17.0.3&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;IPPrefixLen&#34;</span>: 16,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;IPv6Gateway&#34;</span>: <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>   。。。
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>上面命令运行以后，会输出很多内容，找到<code>IPAddress</code>字段即可。我的机器返回的 IP 地址是<code>172.17.0.3</code>。</p><p>浏览器访问<code>172.17.0.3</code>，就会看到 WordPress 的安装提示。</p><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=NjM4MmQ0MzQ2OGU1NTgzM2ZmM2NkNmJkMzY2M2QyMzdfVVY4dUdnQ1F0ZWM5OW1GaGFZVTFGZ0ZyUkVZRGY0aW5fVG9rZW46Ym94Y25kSURBVXN5NUdndWFBTjlDUTFrdGdkXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><a href=#32-wordpress-容器的定制><h4 id=32-wordpress-容器的定制><span class=hanchor arialabel=Anchor># </span>3.2 WordPress 容器的定制</h4></a><p>到了上一步，官方 WordPress 容器的安装就已经成功了。但是，这种方法有两个很不方便的地方。</p><blockquote><ul><li><p>每次新建容器，返回的 IP 地址不能保证相同，导致要更换 IP 地址访问 WordPress。</p></li><li><p>WordPress 安装在容器里面，本地无法修改文件。</p></li></ul></blockquote><p>解决这两个问题很容易，只要新建容器的时候，加两个命令行参数就可以了。</p><p>先把刚才启动的 WordPress 容器终止（容器文件会自动删除）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container stop wordpress
</span></span></code></pre></td></tr></table></div></div><p>然后，使用下面的命令新建并启动 WordPress 容器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container run <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -d <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -p 127.0.0.2:8080:80 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --rm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --name wordpress <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --env <span class=nv>WORDPRESS_DB_PASSWORD</span><span class=o>=</span><span class=m>123456</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --env <span class=nv>WORDPRESS_DB_USER</span><span class=o>=</span>root <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --link wordpressdb:mysql <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --volume <span class=s2>&#34;</span><span class=nv>$PWD</span><span class=s2>/wordpress&#34;</span>:/var/www/html <span class=se>\\ </span></span></span><span class=line><span class=cl><span class=se></span>  wordpress
</span></span></code></pre></td></tr></table></div></div><p>上面的命令跟前面相比，命令行参数只多出了两个。</p><blockquote><ul><li><p><code>-p 127.0.0.2:8080:80</code>：将容器的 80 端口映射到<code>127.0.0.2</code>的<code>8080</code>端口。</p></li><li><p><code>--volume "$PWD/wordpress":/var/www/html</code>：将容器的<code>/var/www/html</code>目录映射到当前目录的<code>wordpress</code>子目录。</p></li></ul></blockquote><p>浏览器访问<code>127.0.0.2:8080</code>就能看到 WordPress 的安装提示了。而且，你在<code>wordpress</code>子目录下的每次修改，都会反映到容器里面。</p><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=NTY2NGJjYjUxM2ViNjM0YjEzNTQ3MzQ0YWJlMmVlMmJfVm9nVzRRVkRVcmtUcDJUQzBmVDR2OVhTNnJxeVdYY2VfVG9rZW46Ym94Y25lYzlUMW1meUlLNXdEWGREVFZIUmJnXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><p>最后，终止这两个容器（容器文件会自动删除）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker container stop wordpress wordpressdb
</span></span></code></pre></td></tr></table></div></div><a href=#四方法-cdocker-compose-工具><h3 id=四方法-cdocker-compose-工具><span class=hanchor arialabel=Anchor># </span>四、方法 C：Docker Compose 工具</h3></a><p>上面的方法 B 已经挺简单了，但是必须自己分别启动两个容器，启动的时候，还要在命令行提供容器之间的连接信息。因此，Docker 提供了一种更简单的方法，来管理多个容器的联动。</p><a href=#41-docker-compose-简介><h4 id=41-docker-compose-简介><span class=hanchor arialabel=Anchor># </span>4.1 Docker Compose 简介</h4></a><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=MGZjZTA4YTllOTk0MDZlYjY3ZDI1NzUyZDUyNmU1MTlfU3pPR0Y0ZjlCQjBMWjZXMW9uQ0FvUFlzdmFuM2xLZVpfVG9rZW46Ym94Y25Nbk9lYm55UUNPaUc1bnpoRjA5QktRXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><p><a href=https://docs.docker.com/compose/ rel=noopener>Compose</a> 是 Docker 公司推出的一个工具软件，可以管理多个 Docker 容器组成一个应用。你需要定义一个
<a href=https://www.ruanyifeng.com/blog/2016/07/yaml.html rel=noopener>YAML</a> 格式的配置文件<code>docker-compose.yml</code>，写好多个容器之间的调用关系。然后，只要一个命令，就能同时启动/关闭这些容器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl><span class=c1># 启动所有服务</span>
</span></span><span class=line><span class=cl>docker compose up
</span></span><span class=line><span class=cl><span class=c1># 关闭所有服务</span>
</span></span><span class=line><span class=cl>docker compose stop
</span></span></code></pre></td></tr></table></div></div><a href=#42-docker-compose-的安装><h4 id=42-docker-compose-的安装><span class=hanchor arialabel=Anchor># </span>4.2 Docker Compose 的安装</h4></a><p>Mac 和 Windows 在安装 docker 的时候，会一起安装 docker compose。Linux 系统下的安装参考
<a href=https://docs.docker.com/compose/install/#install-compose rel=noopener>官方文档</a>。</p><p>安装完成后，运行下面的命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker compose version
</span></span><span class=line><span class=cl>Docker Compose version v2.6.0
</span></span></code></pre></td></tr></table></div></div><a href=#43-wordpress-示例><h4 id=43-wordpress-示例><span class=hanchor arialabel=Anchor># </span>4.3 WordPress 示例</h4></a><p>在<code>docker-demo</code>目录下，新建<code>docker-compose.yml</code>文件，写入下面的内容。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>version: <span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>services:
</span></span><span class=line><span class=cl>  mysql:
</span></span><span class=line><span class=cl>    image: mysql:5.7
</span></span><span class=line><span class=cl>    environment:
</span></span><span class=line><span class=cl>     - <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=m>123456</span>
</span></span><span class=line><span class=cl>     - <span class=nv>MYSQL_DATABASE</span><span class=o>=</span>wordpress
</span></span><span class=line><span class=cl>  web:
</span></span><span class=line><span class=cl>    image: wordpress
</span></span><span class=line><span class=cl>    links:
</span></span><span class=line><span class=cl>     - mysql
</span></span><span class=line><span class=cl>    environment:
</span></span><span class=line><span class=cl>     - <span class=nv>WORDPRESS_DB_PASSWORD</span><span class=o>=</span><span class=m>123456</span>
</span></span><span class=line><span class=cl>     - <span class=nv>WORDPRESS_DB_USER</span><span class=o>=</span>root
</span></span><span class=line><span class=cl>    ports:
</span></span><span class=line><span class=cl>     - <span class=s2>&#34;127.0.0.3:8080:80&#34;</span>
</span></span><span class=line><span class=cl>    working_dir: /var/www/html
</span></span></code></pre></td></tr></table></div></div><p>上面代码中，两个顶层标签表示有两个容器<code>mysql</code>和<code>web</code>。每个容器的具体设置，前面都已经讲解过了，还是挺容易理解的。</p><p>启动两个容器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker compose up
</span></span></code></pre></td></tr></table></div></div><p>浏览器访问 http://127.0.0.3:8080，应该就能看到 WordPress 的安装界面。</p><p><img src="https://j0tzfdufdk.feishu.cn/space/api/box/stream/download/asynccode/?code=YTYyMWNjMTE5ZDJiN2E3NmM2ZjQ5ZTkzZjk5NTZlZjlfQnEwYXgxZlRYTVBmeU5hU2RFaGRoNm9jekdCZmtldzFfVG9rZW46Ym94Y25tUkxqcm04YlRoZzI5Z3BRWHRwUFdlXzE2NzEwMTE4MDE6MTY3MTAxNTQwMV9WNA" width=auto alt=img></p><p>现在关闭两个容器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker compose stop
</span></span></code></pre></td></tr></table></div></div><p>关闭以后，这两个容器文件还是存在的，写在里面的数据不会丢失。下次启动的时候，还可以复用。下面的命令可以把这两个容器文件删除（容器必须已经停止运行）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker compose rm
</span></span></code></pre></td></tr></table></div></div><a href=#五参考链接><h3 id=五参考链接><span class=hanchor arialabel=Anchor># </span>五、参考链接</h3></a><ul><li><p><a href=https://www.sitepoint.com/how-to-manually-build-docker-containers-for-wordpress/ rel=noopener>How to Manually Build Docker Containers for WordPress</a>, by Aleksander Koko</p></li><li><p><a href=https://www.sitepoint.com/how-to-use-the-official-docker-wordpress-image/ rel=noopener>How to Use the Official Docker WordPress Image</a>, by Aleksander Koko</p></li><li><p><a href=https://www.sitepoint.com/deploying-wordpress-with-docker/ rel=noopener>Deploying WordPress with Docker</a>, by Aleksander Koko</p></li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/digital-garden/notes/devops/ data-ctx="Docker进阶：step by step" data-src=/notes/devops class=internal-link>Data System</a></li><li><a href=/digital-garden/notes/hands-on-docker_1/ data-ctx="Docker进阶：step by step" data-src=/notes/hands-on-docker_1 class=internal-link>Docker入门教程</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://yangls06.github.io/digital-garden/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by yangls06 using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2022</p><ul><li><a href=https://yangls06.github.io/digital-garden/>Home</a></li><li><a href=https://github.com/yangls06>Github</a></li></ul></footer></div></div></body></html>