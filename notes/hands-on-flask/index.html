<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Hands on Flask: step by step  I am a newcomer of Flask. So I follow the official tutorial to build a blog post web application step by step."><title>Hands on Flask</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://yangls06.github.io/digital-garden//icon.png><link href=https://yangls06.github.io/digital-garden/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=https://yangls06.github.io/digital-garden/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://yangls06.github.io/digital-garden/js/darkmode.aa0630d04550405b827df945275af6c3.min.js></script>
<script src=https://yangls06.github.io/digital-garden/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://yangls06.github.io/digital-garden/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://yangls06.github.io/digital-garden/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://yangls06.github.io/digital-garden/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://yangls06.github.io/digital-garden/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://yangls06.github.io/digital-garden/",fetchData=Promise.all([fetch("https://yangls06.github.io/digital-garden/indices/linkIndex.86affe92bde842f45c210208702b1f01.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://yangls06.github.io/digital-garden/indices/contentIndex.2f3cd8dbe3e81c74182fef0a92024598.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://yangls06.github.io/digital-garden",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://yangls06.github.io/digital-garden",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/yangls06.github.io\/digital-garden\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-GQ32FS7YEX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GQ32FS7YEX",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://yangls06.github.io/digital-garden/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://yangls06.github.io/digital-garden/>🪴 无人之路</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Hands on Flask</h1><p class=meta>Last updated
Dec 15, 2022
<a href=https://github.com/yangls06/digital-garden/tree/hugo/content/notes/hands-on-flask.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://yangls06.github.io/digital-garden/tags/python/>Python</a></li><li><a href=https://yangls06.github.io/digital-garden/tags/flask/>Flask</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#reference>Reference</a></li><li><a href=#step-by-step>Step by Step</a><ol><li><a href=#step-0backgroud>Step 0.Backgroud</a></li><li><a href=#step-1-project-layout>Step 1. Project Layout</a></li><li><a href=#step-3-application-setup>Step 3. Application Setup</a></li><li><a href=#step-4-define-and-access-the-database>Step 4. Define and Access the Database</a></li><li><a href=#step-5-blueprints-and-views>Step 5. Blueprints and Views</a></li><li><a href=#step-6-templates>Step 6. Templates</a></li><li><a href=#step-7-static-files>Step 7. Static Files</a></li><li><a href=#step-8-blog-blueprint>Step 8. Blog Blueprint</a></li><li><a href=#step-9-make-the-project-installable>Step 9. Make the Project Installable</a></li></ol></li></ol></nav></details></aside><a href=#hands-on-flask-step-by-step><h1 id=hands-on-flask-step-by-step><span class=hanchor arialabel=Anchor># </span>Hands on Flask: step by step</h1></a><blockquote><p>I am a newcomer of Flask. So I follow the official tutorial to build a blog post web application step by step.</p></blockquote><a href=#reference><h2 id=reference><span class=hanchor arialabel=Anchor># </span>Reference</h2></a><p><a href=https://flask.palletsprojects.com/en/2.2.x/installation/ rel=noopener>Flask Installation</a></p><p><a href=https://flask.palletsprojects.com/en/2.2.x/tutorial/ rel=noopener>Flask Tutorial</a></p><p>Follow the tutorial to build a blog web app like:</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221201145000837.png width=auto alt=image-20221201145000837></p><a href=#step-by-step><h2 id=step-by-step><span class=hanchor arialabel=Anchor># </span>Step by Step</h2></a><a href=#step-0backgroud><h3 id=step-0backgroud><span class=hanchor arialabel=Anchor># </span>Step 0.Backgroud</h3></a><p>build a basic blog application called Flaskr using Flask.</p><a href=#step-1-project-layout><h3 id=step-1-project-layout><span class=hanchor arialabel=Anchor># </span>Step 1. Project Layout</h3></a><a href=#create-a-project-directory><h4 id=create-a-project-directory><span class=hanchor arialabel=Anchor># </span>Create a project directory</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mkdir flask-tutorial
</span></span><span class=line><span class=cl><span class=nb>cd</span> flask-tutorial/
</span></span></code></pre></td></tr></table></div></div><a href=#install-flask><h4 id=install-flask><span class=hanchor arialabel=Anchor># </span>Install Flask</h4></a><p><a href=https://flask.palletsprojects.com/en/2.2.x/installation/ rel=noopener>Flask Installation Doc</a></p><p>Create an python environment using
<a href=https://docs.python.org/3/library/venv.html#module-venv rel=noopener>venv</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ python3 -m venv venv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ tree . -L <span class=m>3</span>
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>└── venv
</span></span><span class=line><span class=cl>    ├── bin
</span></span><span class=line><span class=cl>    │   ├── Activate.ps1
</span></span><span class=line><span class=cl>    │   ├── activate
</span></span><span class=line><span class=cl>    │   ├── activate.csh
</span></span><span class=line><span class=cl>    │   ├── activate.fish
</span></span><span class=line><span class=cl>    │   ├── pip
</span></span><span class=line><span class=cl>    │   ├── pip3
</span></span><span class=line><span class=cl>    │   ├── pip3.9
</span></span><span class=line><span class=cl>    │   ├── python -&gt; python3
</span></span><span class=line><span class=cl>    │   ├── python3 -&gt; /Users/yangls06/opt/miniconda3/bin/python3
</span></span><span class=line><span class=cl>    │   └── python3.9 -&gt; python3
</span></span><span class=line><span class=cl>    ├── include
</span></span><span class=line><span class=cl>    ├── lib
</span></span><span class=line><span class=cl>    │   └── python3.9
</span></span><span class=line><span class=cl>    └── pyvenv.cfg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>5</span> directories, <span class=m>11</span> files
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ tree venv/lib/python3.9/ -L <span class=m>3</span>
</span></span><span class=line><span class=cl>venv/lib/python3.9/
</span></span><span class=line><span class=cl>└── site-packages
</span></span><span class=line><span class=cl>    ├── _distutils_hack
</span></span><span class=line><span class=cl>    │   ├── __init__.py
</span></span><span class=line><span class=cl>    │   ├── __pycache__
</span></span><span class=line><span class=cl>    │   └── override.py
</span></span><span class=line><span class=cl>    ├── distutils-precedence.pth
</span></span><span class=line><span class=cl>    ├── pip
</span></span><span class=line><span class=cl>    │   ├── __init__.py
</span></span><span class=line><span class=cl>    │   ├── __main__.py
</span></span><span class=line><span class=cl>        ...
</span></span><span class=line><span class=cl>    ├── pkg_resources
</span></span><span class=line><span class=cl>    ...
</span></span></code></pre></td></tr></table></div></div><p>Activate the environment</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ . venv/bin/activate
</span></span></code></pre></td></tr></table></div></div><p>Then the environment has been changed.</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221201153333547.png width=auto alt=image-20221201153333547></p><p>Install Flask</p><p>Within the activated environment, install Flask using <code>pip</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ pip install Flask
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Looking in indexes: https://pypi.douban.com/simple
</span></span><span class=line><span class=cl>Collecting Flask
</span></span><span class=line><span class=cl>  Downloading https://pypi.doubanio.com/packages/0f/43/15f4f9ab225b0b25352412e8daa3d0e3d135fcf5e127070c74c3632c8b4c/Flask-2.2.2-py3-none-any.whl <span class=o>(</span><span class=m>101</span> kB<span class=o>)</span>
</span></span><span class=line><span class=cl>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 101.5/101.5 KB 1.8 MB/s eta 0:00:00
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Collecting MarkupSafe&gt;<span class=o>=</span>2.0
</span></span><span class=line><span class=cl>  Downloading https://pypi.doubanio.com/packages/06/7f/d5e46d7464360b6ac39c5b0b604770dba937e3d7cab485d2f3298454717b/MarkupSafe-2.1.1-cp39-cp39-macosx_10_9_universal2.whl <span class=o>(</span><span class=m>17</span> kB<span class=o>)</span>
</span></span><span class=line><span class=cl>Installing collected packages: zipp, MarkupSafe, itsdangerous, click, Werkzeug, Jinja2, importlib-metadata, Flask
</span></span><span class=line><span class=cl>Successfully installed Flask-2.2.2 Jinja2-3.1.2 MarkupSafe-2.1.1 Werkzeug-2.2.2 click-8.1.3 importlib-metadata-5.1.0 itsdangerous-2.1.2 zipp-3.11.0
</span></span></code></pre></td></tr></table></div></div><p>Git init</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ git init
</span></span></code></pre></td></tr></table></div></div><p>with <code>.gitignore</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>venv/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*.pyc
</span></span><span class=line><span class=cl>__pycache__/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>instance/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.pytest_cache/
</span></span><span class=line><span class=cl>.coverage
</span></span><span class=line><span class=cl>htmlcov/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>dist/
</span></span><span class=line><span class=cl>build/
</span></span><span class=line><span class=cl>*.egg-info/
</span></span></code></pre></td></tr></table></div></div><p>Add folders</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ tree -a -L <span class=m>1</span>
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── .git
</span></span><span class=line><span class=cl>├── .gitignore
</span></span><span class=line><span class=cl>├── flaskr
</span></span><span class=line><span class=cl>├── tests
</span></span><span class=line><span class=cl>└── venv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>4</span> directories, <span class=m>1</span> file
</span></span></code></pre></td></tr></table></div></div><a href=#step-3-application-setup><h3 id=step-3-application-setup><span class=hanchor arialabel=Anchor># </span>Step 3. Application Setup</h3></a><a href=#the-application-factory-__init__py><h4 id=the-application-factory-__init__py><span class=hanchor arialabel=Anchor># </span>The Application Factory: _<em>init</em>_.py</h4></a><ul><li>create <code>Flask</code> instance</li><li>make <code>flaskr</code> directory a package</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python</span>
</span></span><span class=line><span class=cl><span class=c1># -*- encoding: utf-8 -*-</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>@Time    :   2022/12/01 15:58:24
</span></span></span><span class=line><span class=cl><span class=s2>@Author  :   Linsan Yang 
</span></span></span><span class=line><span class=cl><span class=s2>@Desc    :   init flaskr
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_app</span><span class=p>(</span><span class=n>test_config</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># create and configure the app</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>,</span> <span class=n>instance_relative_config</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>from_mapping</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>SECRET_KEY</span> <span class=o>=</span> <span class=s1>&#39;dev&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>DATABASE</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>instance_path</span><span class=p>,</span> <span class=s1>&#39;flaskr.sqlite&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>test_config</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># load the instance config, if it exists, when not testing</span>
</span></span><span class=line><span class=cl>        <span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>from_pyfile</span><span class=p>(</span><span class=s1>&#39;config.py&#39;</span><span class=p>,</span> <span class=n>silent</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># load the test config if passed in</span>
</span></span><span class=line><span class=cl>        <span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>from_mapping</span><span class=p>(</span><span class=n>test_config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># ensure the instance folder exists</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>instance_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>OSError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># a simple page that says hello</span>
</span></span><span class=line><span class=cl>    <span class=nd>@app</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/hello&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>hello</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;Hello, World!&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>app</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>instance folder</strong></p><p>There will be a <code>instance/</code>directory, located outside the <code>flaskr</code> package and can hold local data that shouldn’t be committed to version control, such as configuration secrets and the database file.</p><p><strong>test_config</strong></p><p>Using test_config for testing.</p><p><strong>@app.route()</strong></p><p>create a simple route of <code>/hello</code></p><a href=#run-the-application><h4 id=run-the-application><span class=hanchor arialabel=Anchor># </span>Run The Application</h4></a><p>In the <code>flask-tutorial</code> dir not <code>flaskr</code> package:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ flask --app flaskr --debug run
</span></span><span class=line><span class=cl> * Serving Flask app <span class=s1>&#39;flaskr&#39;</span>
</span></span><span class=line><span class=cl> * Debug mode: on
</span></span><span class=line><span class=cl>WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
</span></span><span class=line><span class=cl> * Running on http://127.0.0.1:5000
</span></span><span class=line><span class=cl>Press CTRL+C to quit
</span></span><span class=line><span class=cl> * Restarting with stat
</span></span><span class=line><span class=cl> * Debugger is active!
</span></span><span class=line><span class=cl> * Debugger PIN: 134-914-837
</span></span></code></pre></td></tr></table></div></div><p>Then open 127.0.0.1:5000/hello in browser, got</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221201162507048.png width=auto alt=image-20221201162507048></p><a href=#step-4-define-and-access-the-database><h3 id=step-4-define-and-access-the-database><span class=hanchor arialabel=Anchor># </span>Step 4. Define and Access the Database</h3></a><p>The app will use <code>Sqlite</code> database to store users and posts. Python has a built-in module <code>sqlite3</code> module.</p><a href=#connect-to-sqlite><h4 id=connect-to-sqlite><span class=hanchor arialabel=Anchor># </span>Connect to Sqlite</h4></a><p>flaskr/db.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sqlite3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>click</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>current_app</span><span class=p>,</span> <span class=n>g</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_db</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;db&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>g</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=o>.</span><span class=n>db</span> <span class=o>=</span> <span class=n>sqlite3</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>current_app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;DATABASE&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>detect_types</span><span class=o>=</span><span class=n>sqlite3</span><span class=o>.</span><span class=n>PARSE_DECLTYPES</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>row_factory</span> <span class=o>=</span> <span class=n>sqlite3</span><span class=o>.</span><span class=n>Row</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>g</span><span class=o>.</span><span class=n>db</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>close_db</span><span class=p>(</span><span class=n>e</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span> <span class=o>=</span> <span class=n>g</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s1>&#39;db&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>db</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>db</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><code>g</code> is a spectial object for each request to share data among different functions. <code>current_app</code> is similar.</p><a href=#create-tables-using-sql><h4 id=create-tables-using-sql><span class=hanchor arialabel=Anchor># </span>Create Tables: using sql</h4></a><p>Define <code>user</code> and <code>post</code> table in <code>flaskr/schema.sql</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=n>post</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=n>AUTOINCREMENT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>username</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>password</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>post</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=n>AUTOINCREMENT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>author_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>created</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>CURRENT_TIMESTAMP</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>title</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>body</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=n>author_id</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Add functions to run the SQLs to the <code>db.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>init_db</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span> <span class=o>=</span> <span class=n>get_db</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>current_app</span><span class=o>.</span><span class=n>open_resource</span><span class=p>(</span><span class=s1>&#39;schema.sql&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>db</span><span class=o>.</span><span class=n>executescript</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@click</span><span class=o>.</span><span class=n>command</span><span class=p>(</span><span class=s1>&#39;init-db&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>init_db_command</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;&#39;&#39;Clear the existing data and create new tables.&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>init_db</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>click</span><span class=o>.</span><span class=n>echo</span><span class=p>(</span><span class=s1>&#39;Initialized the database.&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><a href=#register-with-the-applicaiton><h4 id=register-with-the-applicaiton><span class=hanchor arialabel=Anchor># </span>Register with the Applicaiton</h4></a><p>The close_db and init_db_command functions need to be registered with the app instance for use.</p><p>In <code>db.py</code> add a new <code>init_app</code> function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>init_app</span><span class=p>(</span><span class=n>app</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># tells Flask to call that function when cleaning up after returning the response</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>teardown_appcontext</span><span class=p>(</span><span class=n>close_db</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># adds a new command that can be called with the flask command</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>cli</span><span class=o>.</span><span class=n>add_command</span><span class=p>(</span><span class=n>init_db_command</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Then import and call this function from the factory in <code>__init__.py</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_app</span><span class=p>(</span><span class=n>test_config</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># create and configure the app</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span> <span class=o>=</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=c1># existing code omitted</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># add db functions</span>
</span></span><span class=line><span class=cl>    <span class=kn>from</span> <span class=nn>.</span> <span class=kn>import</span> <span class=n>db</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>init_app</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>app</span>
</span></span></code></pre></td></tr></table></div></div><a href=#initialize-the-database><h4 id=initialize-the-database><span class=hanchor arialabel=Anchor># </span>Initialize the Database</h4></a><p>Now use <code>init-db</code>command like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ flask --app flaskr init-db
</span></span><span class=line><span class=cl>Initialized the database.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ tree instance/
</span></span><span class=line><span class=cl>instance/
</span></span><span class=line><span class=cl>└── flaskr.sqlite
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>0</span> directories, <span class=m>1</span> file
</span></span></code></pre></td></tr></table></div></div><p>The command generates a sqlite db file <code>flaskr.sqlite</code> in <code>instance/</code> dir.</p><a href=#step-5-blueprints-and-views><h3 id=step-5-blueprints-and-views><span class=hanchor arialabel=Anchor># </span>Step 5. Blueprints and Views</h3></a><p>Referances:</p><p><a href=https://flask.palletsprojects.com/en/2.2.x/tutorial/views/ rel=noopener>Blueprints and Views</a></p><p><a href="https://realpython.com/flask-blueprint/#:~:text=Flask-is-a-very-popular,its-functionality-into-reusable-components" rel=noopener>Use a Flask Blueprint to Architect Your Applications</a></p><p>Concept: view</p><p>A view is Flask&rsquo;s respond to the outgoing request. Flask uses patterns to match the incoming request URL to the view that should handle it.</p><p>Concept: blueprint</p><p>A blueprint is a way to organize a group of related views and other code. Rather than registering views and other code directly with an application, they are registered with a blueprint. Then the blueprint is registered with the application when it is available in the factory function.</p><a href=#create-a-blueprint><h4 id=create-a-blueprint><span class=hanchor arialabel=Anchor># </span>Create a Blueprint</h4></a><p>Flaskr will have two blueprints:</p><ul><li>auth functions</li><li>blog posts functions</li></ul><p><code>Flaskr/auth.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>functools</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>Blueprint</span><span class=p>,</span> <span class=n>flash</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>redirect</span><span class=p>,</span> <span class=n>render_template</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>session</span><span class=p>,</span> <span class=n>url_for</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>werkzeug.security</span> <span class=kn>import</span> <span class=n>check_password_hash</span><span class=p>,</span> <span class=n>generate_password_hash</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flaskr.db</span> <span class=kn>import</span> <span class=n>get_db</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>bp</span> <span class=o>=</span> <span class=n>Blueprint</span><span class=p>(</span><span class=s1>&#39;auth&#39;</span><span class=p>,</span> <span class=vm>__name__</span><span class=p>,</span> <span class=n>url_prefix</span><span class=o>=</span><span class=s1>&#39;/auth&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>A new <code>Blueprint</code> is created:</p><ul><li>with <code>name</code>: &lsquo;auth&rsquo;</li><li>with <code>import_name</code>: &lsquo;_<em>name</em>_&rsquo;, helping the blueprint to know where it’s defined</li><li>with <code>url_prefix</code>: will be prepended (added at head)to all the URLs associated with this blueprint.</li></ul><p>Then register the blueprint to the app from the factory in the <code>__init__.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_app</span><span class=p>(</span><span class=n>test_config</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># create and configure the app</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span> <span class=o>=</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=c1># existing code omitted</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># add auth blueprint</span>
</span></span><span class=line><span class=cl>    <span class=kn>from</span> <span class=nn>.</span> <span class=kn>import</span> <span class=n>auth</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>register_blueprint</span><span class=p>(</span><span class=n>auth</span><span class=o>.</span><span class=n>bp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>app</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Referances:</p><p><a href=https://docs.python.org/3/library/functools.html rel=noopener>Python functools</a></p></blockquote><a href=#register-view><h4 id=register-view><span class=hanchor arialabel=Anchor># </span>Register view</h4></a><p>When the user visits the <code>/auth/register</code> URL, the <code>register</code> view will return
<a href=https://developer.mozilla.org/docs/Web/HTML rel=noopener>HTML</a> with a form for them to fill out. When they submit the form, it will validate their input and either show the form again with an error message or create the new user and go to the login page.</p><p>The view code is as following in <code>flaskr/auth.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@bp</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/register&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>register</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>db</span> <span class=o>=</span> <span class=n>get_db</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>error</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>username</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>error</span> <span class=o>=</span> <span class=s1>&#39;Username is required.&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=ow>not</span> <span class=n>password</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>error</span> <span class=o>=</span> <span class=s1>&#39;Password is required.&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>error</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;INSERT INTO user (username, password) VALUES (?, ?)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>generate_password_hash</span><span class=p>(</span><span class=n>password</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=n>db</span><span class=o>.</span><span class=n>IntegrityError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>error</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;User </span><span class=si>{</span><span class=n>username</span><span class=si>}</span><span class=s2> is already registered.&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;auth.login&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>flash</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;auth/register.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>register</code> view works as following:</p><ul><li>@bp.route associates the URL <code>/register</code> with the <code>register</code> view.</li><li>If the user submited the register form, <code>request.method == 'POST'</code>, then validate the input <code>username</code> and <code>password</code> and store them into the database.</li><li>If storing the user info succeeds, then redirect to the <code>auth.login</code> page.</li><li>If the user is initially landing on the <code>register</code> page, or there was a validation error, the <code>register.html</code> will be shown.</li></ul><a href=#login-view><h4 id=login-view><span class=hanchor arialabel=Anchor># </span>Login view</h4></a><p>This view follows the same pattern as <code>register</code> view.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl> <span class=nd>@bp</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>db</span> <span class=o>=</span> <span class=n>get_db</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>error</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;SELECT * FROM user WHERE username = ?&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>username</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span><span class=o>.</span><span class=n>fetchone</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>error</span> <span class=o>=</span> <span class=s1>&#39;Incorrect username.&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=ow>not</span> <span class=n>check_password_hash</span><span class=p>(</span><span class=n>user</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>],</span> <span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>error</span> <span class=o>=</span> <span class=s1>&#39;Incorrect password.&#39;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>error</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>session</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>session</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;index&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>flash</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;auth/login.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Tips:</p><ul><li>The user info is queried and stored in <code>user</code> variable using <code>fetch_one</code> function.</li><li>Validate the <code>username</code> and <code>password</code> (by <code>check_password_hash</code>) inputs.</li><li>The <code>session</code> (a dict storing data across requests) refreshes if login succeeds. (The data is stored in a <em>cookie</em> that is sent to the browser, and the browser then sends it back with subsequent requests.)</li></ul><p>We can get user info at the beginning of each request via <code>session</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@bp</span><span class=o>.</span><span class=n>before_app_request</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_logged_in_user</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>user_id</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=o>.</span><span class=n>user</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=o>.</span><span class=n>user</span> <span class=o>=</span> <span class=n>get_db</span><span class=p>()</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;SELECT * FROM user WHERE id = ?&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>user_id</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span><span class=o>.</span><span class=n>fetchone</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>Tips:</p><ul><li><a href=https://flask.palletsprojects.com/en/2.2.x/api/#flask.Blueprint.before_app_request rel=noopener><code>bp.before_app_request()</code></a> registers a function that runs before the view function, no matter what URL is requested.</li><li><code>load_logged_in_user</code> gets that user info from the database via <code>session</code> and stores it on
<a href=https://flask.palletsprojects.com/en/2.2.x/api/#flask.g rel=noopener><code>g.user</code></a>, which lasts for the length of the request.</li></ul><a href=#logout-view><h4 id=logout-view><span class=hanchor arialabel=Anchor># </span>Logout view</h4></a><p>The Logout view removes the user id from the
<a href=https://flask.palletsprojects.com/en/2.2.x/api/#flask.session rel=noopener><code>session</code></a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@bp</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/logout&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>logout</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>session</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;index&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><a href=#require-auth-in-other-views><h4 id=require-auth-in-other-views><span class=hanchor arialabel=Anchor># </span>Require Auth in Other views</h4></a><p>Creating, editing and deleting blog posts requires the user to be logged in. Use a <strong>decorator</strong> to achieve this.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>login_required</span><span class=p>(</span><span class=n>view</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@functools</span><span class=o>.</span><span class=n>wraps</span><span class=p>(</span><span class=n>view</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>wrapped_view</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>g</span><span class=o>.</span><span class=n>user</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;auth.login&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>view</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>wrapped_view</span> 
</span></span></code></pre></td></tr></table></div></div><p>This decorator wraps the view in this way: if a user is not logged in, then redirect to login page; if logged in, return the orginal view.</p><a href=#step-6-templates><h3 id=step-6-templates><span class=hanchor arialabel=Anchor># </span>Step 6. Templates</h3></a><p>Though <code>auth.login</code> view has been created, a <code>TemplateNotFound</code> error will be raised when you visit http://127.0.0.1:5000/auth/login.</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221202154357379.png width=auto alt=image-20221202154357379></p><p>This is because the view calls <code>render_template()</code>, but no templates are created.</p><p>Tips:</p><ul><li>The template files will be stored in the <code>templates</code> directory inside the <code>flaskr</code> package.</li><li>Templates are files that contain static data as well as placeholders for dynamic data.</li><li>A template is rendered with specific data to produce a final document. Flask uses the
<a href=https://jinja.palletsprojects.com/templates/ rel=noopener>Jinja</a> template library to render templates.</li><li>Special delimiters are used to distinguish Jinja syntax from the static data in the template.<ul><li>Anything between <code>{{</code> and <code>}}</code> is an expression that will be output to the final document.</li><li><code>{%</code> and <code>%}</code> denotes a control flow statement like <code>if</code> and <code>for</code></li></ul></li></ul><a href=#the-base-layout><h4 id=the-base-layout><span class=hanchor arialabel=Anchor># </span>The Base Layout</h4></a><p>Each page in the app has the same basic layout around a different body.Instead of writing the entire HTML structure in each template, each template will extend a base template and override specific sections.</p><p>File: <code>flaskr/templates/base.html</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>{% block title %}{% endblock %} - Flaskr<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ url_for(&#39;static&#39;, filename=&#39;style.css&#39;) }}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>nav</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>   <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>Flaskr<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>   <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {% if g.user %}
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;&lt;</span><span class=nt>span</span><span class=p>&gt;</span>{{ g.user[&#39;username&#39;] }}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ url_for(&#39;auth.logout&#39;) }}&#34;</span><span class=p>&gt;</span>Log Out<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {% else %}
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ url_for(&#39;auth.register&#39;) }}&#34;</span><span class=p>&gt;</span>Register<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ url_for(&#39;auth.login&#39;) }}&#34;</span><span class=p>&gt;</span>Log <span class=p>&lt;</span><span class=nt>Input:c</span><span class=p>&gt;&lt;/</span><span class=nt>Input:c</span><span class=p>&gt;&lt;/</span><span class=nt>a</span><span class=p>&gt;&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {% endif %}
</span></span><span class=line><span class=cl>   <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span> 
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>nav</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>section</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;content&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        {% block header %}
</span></span><span class=line><span class=cl>        {% endblock %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {% for message in get_flashed_messages() %}
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;flash&#34;</span><span class=p>&gt;</span>{{ message }}<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {% endfor %}
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    {% block content %}
</span></span><span class=line><span class=cl>    {% endblock %}
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>section</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Notes: Using <code>Jinja Snippets</code> and <code>HTML CSS Support</code> extensions in vscode is helpful to write html code of Jinja templates.</p></blockquote><p>There are three blocks defined here that will be overridden in the other templates:</p><ul><li><code>{% block title %}</code> will change the title displayed in the browser’s tab and window title.</li><li><code>{% block header %}</code> is similar to <code>title</code> but will change the title displayed on the page.</li><li><code>{% block content %}</code> is where the content of each page goes, such as the login form or a blog post.</li></ul><p>The base template is directly in the <code>templates</code> directory. To keep the others organized, the templates for a blueprint will be placed in a directory with the same name as the blueprint.</p><a href=#register-template><h4 id=register-template><span class=hanchor arialabel=Anchor># </span>Register template</h4></a><p>File: <code>flaskr/templates/register.html</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{% extends &#39;base.html&#39; %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block header %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{% block title %}Register{% endblock %}<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{% endblock %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block content %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;username&#34;</span><span class=p>&gt;</span>Username<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;username&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;username&#34;</span> <span class=na>required</span><span class=p>&gt;</span>        
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;password&#34;</span><span class=p>&gt;</span>Password<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>required</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;Register&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{% endblock %}
</span></span></code></pre></td></tr></table></div></div><a href=#log-in-template><h4 id=log-in-template><span class=hanchor arialabel=Anchor># </span>Log In template</h4></a><p>This is identical to the register template except for the title and submit button.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{% extends &#39;base.html&#39; %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block header %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{% block title %}Log In{% endblock %}<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{% endblock %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block content %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;username&#34;</span><span class=p>&gt;</span>Username<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;username&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;username&#34;</span> <span class=na>required</span><span class=p>&gt;</span>        
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;password&#34;</span><span class=p>&gt;</span>Password<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>required</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;Log In&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{% endblock %}
</span></span></code></pre></td></tr></table></div></div><a href=#register-a-user><h4 id=register-a-user><span class=hanchor arialabel=Anchor># </span>Register a user</h4></a><p>Visit http://127.0.0.1:5000/auth/register</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221202174125671.png width=auto alt=image-20221202174125671></p><p>If no password inputed, you will see:</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221202174349791.png width=auto alt=image-20221202174349791></p><p>If register succeeds, it will redirect to login page:</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221202174548748.png width=auto alt=image-20221202174548748></p><p>If incorrect password is inputed, you will get <code>Incorrect password</code> warning:</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221202174721957.png width=auto alt=image-20221202174721957></p><a href=#step-7-static-files><h3 id=step-7-static-files><span class=hanchor arialabel=Anchor># </span>Step 7. Static Files</h3></a><p>Use css file in the <code>flask/static</code> directory to give the webpages some style. In the <code>base.html</code> template there is already a link to <code>style.css</code> file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{{ url_for(&#39;static&#39;, filename=&#39;style.css&#39;) }}
</span></span></code></pre></td></tr></table></div></div><p>File: flask/static/style.css</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=nt>html</span> <span class=p>{</span> <span class=k>font-family</span><span class=p>:</span> <span class=kc>sans-serif</span><span class=p>;</span> <span class=k>background</span><span class=p>:</span> <span class=mh>#eee</span><span class=p>;</span> <span class=k>padding</span><span class=p>:</span> <span class=mi>1</span><span class=kt>rem</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>body</span> <span class=p>{</span> <span class=k>max-width</span><span class=p>:</span> <span class=mi>960</span><span class=kt>px</span><span class=p>;</span> <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span> <span class=kc>auto</span><span class=p>;</span> <span class=k>background</span><span class=p>:</span> <span class=kc>white</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>h1</span> <span class=p>{</span> <span class=k>font-family</span><span class=p>:</span> <span class=kc>serif</span><span class=p>;</span> <span class=k>color</span><span class=p>:</span> <span class=mh>#377ba8</span><span class=p>;</span> <span class=k>margin</span><span class=p>:</span> <span class=mi>1</span><span class=kt>rem</span> <span class=mi>0</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>a</span> <span class=p>{</span> <span class=k>color</span><span class=p>:</span> <span class=mh>#377ba8</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>hr</span> <span class=p>{</span> <span class=k>border</span><span class=p>:</span> <span class=kc>none</span><span class=p>;</span> <span class=k>border-top</span><span class=p>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=kc>solid</span> <span class=kc>lightgray</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>nav</span> <span class=p>{</span> <span class=k>background</span><span class=p>:</span> <span class=kc>lightgray</span><span class=p>;</span> <span class=k>display</span><span class=p>:</span> <span class=kc>flex</span><span class=p>;</span> <span class=k>align-items</span><span class=p>:</span> <span class=kc>center</span><span class=p>;</span> <span class=k>padding</span><span class=p>:</span> <span class=mi>0</span> <span class=mf>0.5</span><span class=kt>rem</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>nav</span> <span class=nt>h1</span> <span class=p>{</span> <span class=k>flex</span><span class=p>:</span> <span class=kc>auto</span><span class=p>;</span> <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>nav</span> <span class=nt>h1</span> <span class=nt>a</span> <span class=p>{</span> <span class=k>text-decoration</span><span class=p>:</span> <span class=kc>none</span><span class=p>;</span> <span class=k>padding</span><span class=p>:</span> <span class=mf>0.25</span><span class=kt>rem</span> <span class=mf>0.5</span><span class=kt>rem</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>nav</span> <span class=nt>ul</span>  <span class=p>{</span> <span class=k>display</span><span class=p>:</span> <span class=kc>flex</span><span class=p>;</span> <span class=k>list-style</span><span class=p>:</span> <span class=kc>none</span><span class=p>;</span> <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span> <span class=k>padding</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>nav</span> <span class=nt>ul</span> <span class=nt>li</span> <span class=nt>a</span><span class=o>,</span> <span class=nt>nav</span> <span class=nt>ul</span> <span class=nt>li</span> <span class=nt>span</span><span class=o>,</span> <span class=nt>header</span> <span class=p>.</span><span class=nc>action</span> <span class=p>{</span> <span class=k>display</span><span class=p>:</span> <span class=kc>block</span><span class=p>;</span> <span class=k>padding</span><span class=p>:</span> <span class=mf>0.5</span><span class=kt>rem</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>content</span> <span class=p>{</span> <span class=k>padding</span><span class=p>:</span> <span class=mi>0</span> <span class=mi>1</span><span class=kt>rem</span> <span class=mi>1</span><span class=kt>rem</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>content</span> <span class=o>&gt;</span> <span class=nt>header</span> <span class=p>{</span> <span class=k>border-bottom</span><span class=p>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=kc>solid</span> <span class=kc>lightgray</span><span class=p>;</span> <span class=k>display</span><span class=p>:</span> <span class=kc>flex</span><span class=p>;</span> <span class=k>align-items</span><span class=p>:</span> <span class=kc>flex-end</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>content</span> <span class=o>&gt;</span> <span class=nt>header</span> <span class=nt>h1</span> <span class=p>{</span> <span class=k>flex</span><span class=p>:</span> <span class=kc>auto</span><span class=p>;</span> <span class=k>margin</span><span class=p>:</span> <span class=mi>1</span><span class=kt>rem</span> <span class=mi>0</span> <span class=mf>0.25</span><span class=kt>rem</span> <span class=mi>0</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>flash</span> <span class=p>{</span> <span class=k>margin</span><span class=p>:</span> <span class=mi>1</span><span class=kt>em</span> <span class=mi>0</span><span class=p>;</span> <span class=k>padding</span><span class=p>:</span> <span class=mi>1</span><span class=kt>em</span><span class=p>;</span> <span class=k>background</span><span class=p>:</span> <span class=mh>#cae6f6</span><span class=p>;</span> <span class=k>border</span><span class=p>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=kc>solid</span> <span class=mh>#377ba8</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>post</span> <span class=o>&gt;</span> <span class=nt>header</span> <span class=p>{</span> <span class=k>display</span><span class=p>:</span> <span class=kc>flex</span><span class=p>;</span> <span class=k>align-items</span><span class=p>:</span> <span class=kc>flex-end</span><span class=p>;</span> <span class=k>font-size</span><span class=p>:</span> <span class=mf>0.85</span><span class=kt>em</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>post</span> <span class=o>&gt;</span> <span class=nt>header</span> <span class=o>&gt;</span> <span class=nt>div</span><span class=p>:</span><span class=nd>first-of-type</span> <span class=p>{</span> <span class=k>flex</span><span class=p>:</span> <span class=kc>auto</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>post</span> <span class=o>&gt;</span> <span class=nt>header</span> <span class=nt>h1</span> <span class=p>{</span> <span class=k>font-size</span><span class=p>:</span> <span class=mf>1.5</span><span class=kt>em</span><span class=p>;</span> <span class=k>margin-bottom</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>post</span> <span class=p>.</span><span class=nc>about</span> <span class=p>{</span> <span class=k>color</span><span class=p>:</span> <span class=kc>slategray</span><span class=p>;</span> <span class=k>font-style</span><span class=p>:</span> <span class=kc>italic</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>post</span> <span class=p>.</span><span class=nc>body</span> <span class=p>{</span> <span class=k>white-space</span><span class=p>:</span> <span class=kc>pre-line</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>content</span><span class=p>:</span><span class=nd>last-child</span> <span class=p>{</span> <span class=k>margin-bottom</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>content</span> <span class=nt>form</span> <span class=p>{</span> <span class=k>margin</span><span class=p>:</span> <span class=mi>1</span><span class=kt>em</span> <span class=mi>0</span><span class=p>;</span> <span class=k>display</span><span class=p>:</span> <span class=kc>flex</span><span class=p>;</span> <span class=k>flex-direction</span><span class=p>:</span> <span class=kc>column</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>content</span> <span class=nt>label</span> <span class=p>{</span> <span class=k>font-weight</span><span class=p>:</span> <span class=kc>bold</span><span class=p>;</span> <span class=k>margin-bottom</span><span class=p>:</span> <span class=mf>0.5</span><span class=kt>em</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>content</span> <span class=nt>input</span><span class=o>,</span> <span class=p>.</span><span class=nc>content</span> <span class=nt>textarea</span> <span class=p>{</span> <span class=k>margin-bottom</span><span class=p>:</span> <span class=mi>1</span><span class=kt>em</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>content</span> <span class=nt>textarea</span> <span class=p>{</span> <span class=k>min-height</span><span class=p>:</span> <span class=mi>12</span><span class=kt>em</span><span class=p>;</span> <span class=k>resize</span><span class=p>:</span> <span class=kc>vertical</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>input</span><span class=p>.</span><span class=nc>danger</span> <span class=p>{</span> <span class=k>color</span><span class=p>:</span> <span class=mh>#cc2f2e</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nt>input</span><span class=o>[</span><span class=nt>type</span><span class=o>=</span><span class=nt>submit</span><span class=o>]</span> <span class=p>{</span> <span class=k>align-self</span><span class=p>:</span> <span class=kc>start</span><span class=p>;</span> <span class=k>min-width</span><span class=p>:</span> <span class=mi>10</span><span class=kt>em</span><span class=p>;</span> <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>After that, reload the login page, and you can see:</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221202175806462.png width=auto alt=image-20221202175806462></p><a href=#step-8-blog-blueprint><h3 id=step-8-blog-blueprint><span class=hanchor arialabel=Anchor># </span>Step 8. Blog Blueprint</h3></a><p>Implement the blog blueprint to allow a logged-in user to create posts and edit/delete the posts of his/her own.</p><blockquote><p>Note: As you implement each view, keep the development server running. As you save your changes, try going to the URL in your browser and testing them out.</p></blockquote><a href=#the-blog-blueprint><h4 id=the-blog-blueprint><span class=hanchor arialabel=Anchor># </span>The Blog Blueprint</h4></a><p>Define blog blueprint in file: <code>flask/blog.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from flask import (
</span></span><span class=line><span class=cl>    Blueprint, flash, g, redirect, render_template, request, session, url_for
</span></span><span class=line><span class=cl>)
</span></span><span class=line><span class=cl>from werkzeug.exceptions import abort
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>from flaskr.db import get_db
</span></span><span class=line><span class=cl>from flaskr.auth import login_required
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bp = Blueprint(&#39;auth&#39;, __name__)
</span></span></code></pre></td></tr></table></div></div><p>Register this blueprint in the app factory in file : <code>flask/__init__.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_app</span><span class=p>(</span><span class=n>test_config</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># create and configure the app</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span> <span class=o>=</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=c1># existing code omitted</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># add blog blueprint</span>
</span></span><span class=line><span class=cl>    <span class=kn>from</span> <span class=nn>.</span> <span class=kn>import</span> <span class=n>blog</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>register_blueprint</span><span class=p>(</span><span class=n>blog</span><span class=o>.</span><span class=n>bp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>add_url_rule</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=n>endpoint</span><span class=o>=</span><span class=s1>&#39;index&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>app</span>
</span></span></code></pre></td></tr></table></div></div><p>Unlike the auth blueprint, the blog blueprint does not have a <code>url_prefix</code>. So the index view will be at <code>/</code>, the create view at <code>/create</code>. The blog is the main feature of Flaskr app, so it makes sense that the blog index will be the main index.</p><p>The endpoint for index view in blog blueprint will be <code>blog.index</code>. The <code>app.add_url_rule('/', endpoint='index')</code> code associates the endpoint name &lsquo;index&rsquo; with the <code>/</code> url so that <code>url_for('index')</code> or <code>url_for('blog.index')</code> will both work, generating the same <code>/</code> URL either way.</p><a href=#index-view-and-template><h4 id=index-view-and-template><span class=hanchor arialabel=Anchor># </span>Index: view and template</h4></a><p>The index view shows all the posts of the logged-in user, order by created time desc. Use SQL&rsquo;s JOIN clause.</p><p>Define index view in file: <code>flaskr/blog.py</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@bp</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span> <span class=o>=</span> <span class=n>get_db</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>posts</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;SELECT p.id, title, body, created, author_id, username&#39;</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39; FROM post p JOIN user u ON p.author_id = u.id&#39;</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39; ORDER BY created DESC&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;blog/index.html&#39;</span><span class=p>,</span> <span class=n>posts</span><span class=o>=</span><span class=n>posts</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Define index template in file: <code>flaskr/templates/index.html</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{% extends &#39;base.html&#39; %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block header %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{% block title %}Posts{% endblock %}<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {% if g.user %}
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;action&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ url_for(&#39;blog.create&#39;) }}&#34;</span> <span class=p>&gt;</span>New<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {% endif %}
</span></span><span class=line><span class=cl>{% endblock %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block content %}
</span></span><span class=line><span class=cl>    {% for post in posts %}
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>article</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{{ post[&#39;title&#39;] }}<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;about&#34;</span><span class=p>&gt;</span>by {{ post[&#39;username&#39;] }} on {{ post[&#39;created&#39;].strftime(&#39;%Y-%m-%d&#39;) }}<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                {% if g.user[&#39;id&#39;] == post[&#39;author_id&#39;] %}
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;action&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ url_for(&#39;blog.update&#39;, id=post[&#39;id&#39;]) }}&#34;</span><span class=p>&gt;</span>Edit<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                {% endif %}
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>article</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        {% if not loop.last %}
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>hr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        {% endif %}
</span></span><span class=line><span class=cl>    {% endfor %}
</span></span><span class=line><span class=cl>{% endblock %}
</span></span></code></pre></td></tr></table></div></div><p>Tips:</p><ul><li>when a user is logged in, the <code>header</code> block adds a link to the <code>create</code> view.</li><li>when the user is the author of a post, an <code>Edit</code> link to the <code>update</code> view will be seen.</li><li><code>loop.last</code> is a special variable of Jinja&rsquo;s loop.</li></ul><a href=#create-view-and-template><h4 id=create-view-and-template><span class=hanchor arialabel=Anchor># </span>Create: view and template</h4></a><p>The <code>blog.create</code> view acts the similar way as <code>auth.register</code> view.</p><p>Define <code>blog.create</code> view in file: <code>flaskr/blog.py</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@bp</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/create&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nd>@login_required</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>title</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>body</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;body&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>error</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>title</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>error</span> <span class=o>=</span> <span class=s1>&#39;Title is requested.&#39;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>error</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flash</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>db</span> <span class=o>=</span> <span class=n>get_db</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;INSERT INTO post (title, body, author_id)&#39;</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39; VALUES (?, ?, ?)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>title</span><span class=p>,</span> <span class=n>body</span><span class=p>,</span> <span class=n>g</span><span class=o>.</span><span class=n>user</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;blog.index&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;blog/create.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Tips:</p><ul><li>if a new post is POSTed, add it into the database.</li><li>Or display the form of creating post in the <code>create</code> template.</li><li>Login_required decorator is used here to insure the user is logged-in before a new post is created.</li></ul><p>Define the <code>create</code> template in file: <code>flaskr/templates/blog/create.html</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{% extends &#39;base.html&#39; %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block header %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{% block title %}New Post{% endblock %}<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{% endblock %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block content %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;POST&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;title&#34;</span><span class=p>&gt;</span>Title<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;title&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;title&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;{{ request.form[&#39;title&#39;] }}&#34;</span> <span class=na>required</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;body&#34;</span><span class=p>&gt;</span>Body<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>textarea</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;body&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;body&#34;</span><span class=p>&gt;</span>{{ request.form[&#39;body&#39;] }}<span class=p>&lt;/</span><span class=nt>textarea</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;Save&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{% endblock %}
</span></span></code></pre></td></tr></table></div></div><a href=#update-view-and-template><h4 id=update-view-and-template><span class=hanchor arialabel=Anchor># </span>Update: view and template</h4></a><p>Write a <code>get_post()</code> function to fetch a post by id and check if the author equals the logged in user. This function will be used in <code>update</code> and <code>delete</code> view.</p><p>Define get_post() function in file: <code>flaskr/blog.py</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_post</span><span class=p>(</span><span class=nb>id</span><span class=p>,</span> <span class=n>check_author</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>post</span> <span class=o>=</span> <span class=n>get_db</span><span class=p>()</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;SELECT p.id, title, body, created, author_id, user_name&#39;</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39; FROM post p JOIN user u ON p.author_id=u.id&#39;</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39; WHERE p.id = ?&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>id</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=o>.</span><span class=n>fetchone</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>post</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>abort</span><span class=p>(</span><span class=mi>404</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Post id </span><span class=si>{</span><span class=nb>id</span><span class=si>}</span><span class=s1> does not exist.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>check_author</span> <span class=ow>and</span> <span class=n>post</span><span class=p>[</span><span class=s1>&#39;author_id&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=n>g</span><span class=o>.</span><span class=n>user</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>abort</span><span class=p>(</span><span class=mi>403</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>post</span>
</span></span></code></pre></td></tr></table></div></div><p>Tips:</p><ul><li><code>abort()</code> will raise a exception that returns an HTTP status code like 404 (Not Found) or 403 (Forbidden).</li></ul><p>Define <code>update</code> view in file: <code>flaskr/blog.py</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@bp</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/&lt;int:id&gt;/update&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nd>@login_required</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=nb>id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>post</span> <span class=o>=</span> <span class=n>get_post</span><span class=p>(</span><span class=nb>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>title</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>body</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;body&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>error</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>title</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>error</span> <span class=o>=</span> <span class=s1>&#39;Title is required.&#39;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>error</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flash</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>db</span> <span class=o>=</span> <span class=n>get_db</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;UPDATE post SET title = ?, body = ?&#39;</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39; WHERE id = ?&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>title</span><span class=p>,</span> <span class=n>body</span><span class=p>,</span> <span class=nb>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;blog.index&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;blog/update.html&#39;</span><span class=p>,</span> <span class=n>post</span><span class=o>=</span><span class=n>post</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Tips:</p><ul><li><code>update</code> view takes an argument <code>id</code> , which corresponds to the <code>&lt;int:id></code> in the route. A real URL will look like <code>/1/update</code>. And the url_for() function also needs to be passed the <code>id</code> argument in the way of <code>url_for('blog.update', id=post['id'])</code>.</li></ul><p>Define the update template in file: <code>flaskr/templates/blog/update.html</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{% extends &#39;base.html&#39; %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block header %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{% block title %}Edit &#34;{{ post[&#39;title&#39;] }}&#34;{% endblock %}<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{% endblock %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% block content %}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;POST&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;title&#34;</span><span class=p>&gt;</span>Title<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;title&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;title&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;{{ request.form[&#39;title&#39;] or post[&#39;title&#39;] }}&#34;</span> <span class=na>required</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;body&#34;</span><span class=p>&gt;</span>Body<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>textarea</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;body&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;body&#34;</span><span class=p>&gt;</span>{{ request.form[&#39;body&#39;] or post[&#39;body&#39;] }}<span class=p>&lt;/</span><span class=nt>textarea</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;Save&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>hr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;{{ url_for(&#39;blog.delete&#39;, id=post[&#39;id&#39;]) }}&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;Delete&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;danger&#34;</span> <span class=na>onclick</span><span class=o>=</span><span class=s>&#34;return confirm(&#39;Are you sure?&#39;);&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{% endblock %}
</span></span></code></pre></td></tr></table></div></div><p>Tips:</p><ul><li>This templates has two forms:<ul><li>The first one to edit the current post(<code>/&lt;id>/update</code>)</li><li>The other one to delete the post</li></ul></li><li>The pattern <code>{{ request.form['title'] or post['title'] }}</code> is used to choose what data appears in the form.<ul><li>When the form hasn’t been submitted, the original <code>post</code> data appears</li><li>but if invalid form data was posted you want to display that so the user can fix the error, so <code>request.form</code> is used instead.</li></ul></li></ul><a href=#delete-view><h4 id=delete-view><span class=hanchor arialabel=Anchor># </span>Delete: view</h4></a><p>The delete view has no template. Define it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@bp</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/&lt;int:id&gt;/delete&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;POST&#39;</span><span class=p>,))</span>
</span></span><span class=line><span class=cl><span class=nd>@login_required</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>delete</span><span class=p>(</span><span class=nb>id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>get_post</span><span class=p>(</span><span class=nb>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span> <span class=o>=</span> <span class=n>get_db</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s1>&#39;DELETE FROM post WHERE id = ?&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nb>id</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;blog.index&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>Now all code are finished. Try it!</p><p>log in</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221203225939183.png width=auto alt=image-20221203225939183></p><p>Log out</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221203230028831.png width=auto alt=image-20221203230028831></p><p>Create a post</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221203230103978.png width=auto alt=image-20221203230103978></p><p>Writing</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221203230232647.png width=auto alt=image-20221203230232647></p><p>saved</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221203230339421.png width=auto alt=image-20221203230339421></p><p>edit</p><p><img src=https://happy3-data.oss-cn-hangzhou.aliyuncs.com/content-images/image-20221203230548770.png width=auto alt=image-20221203230548770></p><p>Great!</p><a href=#step-9-make-the-project-installable><h3 id=step-9-make-the-project-installable><span class=hanchor arialabel=Anchor># </span>Step 9. Make the Project Installable</h3></a><a href=#describe-the-project><h4 id=describe-the-project><span class=hanchor arialabel=Anchor># </span>Describe the Project</h4></a><p>In order to make the project Installabe, write a <code>setup.py</code> file to describe the project and its dependencies.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>setuptools</span> <span class=kn>import</span> <span class=n>find_packages</span><span class=p>,</span> <span class=n>setup</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>setup</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=o>=</span><span class=s1>&#39;flaskr&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>version</span><span class=o>=</span><span class=s1>&#39;1.0.0&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>=</span><span class=s1>&#39;a simple blog post app based on Flask&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>packages</span><span class=o>=</span><span class=n>find_packages</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>include_package_data</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>requires</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;flask&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Tips:</p><ul><li><code>packages</code> tells Python what package directories to include, and <code>find_packages()</code> function finds them automatically.</li><li>To include other files, such as the static and templates directories, <code>include_package_data</code> is set.</li><li><code>requires</code> tells what modules need to be installed as the project&rsquo;s dependencies.</li><li>Python needs another file named <code>MANIFEST.in</code> to tell what this other data is.</li></ul><p>File <code>MANIFEST.in</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>include flaskr/schema.sql
</span></span><span class=line><span class=cl>graft flaskr/static
</span></span><span class=line><span class=cl>graft flaskr/templates
</span></span><span class=line><span class=cl>global-exclude *.pyc
</span></span></code></pre></td></tr></table></div></div><p>This tells Python to copy everything in the <code>static</code> and <code>templates</code> directories, and the <code>schema.sql</code> file, but to exclude all bytecode files.</p><a href=#install-the-project><h4 id=install-the-project><span class=hanchor arialabel=Anchor># </span>Install the Project</h4></a><p>Use pip to install your project in the virtual environment.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ pip install -e .
</span></span><span class=line><span class=cl>Looking in indexes: https://pypi.douban.com/simple
</span></span><span class=line><span class=cl>Obtaining file:///Users/yangls06/work/flask/flask-tutorial/flaskr
</span></span><span class=line><span class=cl>  Preparing metadata <span class=o>(</span>setup.py<span class=o>)</span> ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Installing collected packages: flaskr
</span></span><span class=line><span class=cl>  Running setup.py develop <span class=k>for</span> flaskr
</span></span><span class=line><span class=cl>Successfully installed flaskr-1.0.0
</span></span></code></pre></td></tr></table></div></div><p>This tells pip to find <code>setup.py</code> in the current directory and install it in <em>editable</em> or <em>development</em> mode.</p><p>Editable mode means that as you make changes to your local code, you’ll only need to re-install if you change the metadata about the project, such as its dependencies.</p><p>You can observe that the project is now installed with <code>pip list</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ pip list
</span></span><span class=line><span class=cl>Package            Version Editable project location
</span></span><span class=line><span class=cl>------------------ ------- ------------------------------------------------
</span></span><span class=line><span class=cl>click              8.1.3
</span></span><span class=line><span class=cl>Flask              2.2.2
</span></span><span class=line><span class=cl>flaskr             1.0.0   /Users/yangls06/work/flask/flask-tutorial/flaskr
</span></span><span class=line><span class=cl>importlib-metadata 5.1.0
</span></span><span class=line><span class=cl>itsdangerous       2.1.2
</span></span><span class=line><span class=cl>Jinja2             3.1.2
</span></span><span class=line><span class=cl>MarkupSafe         2.1.1
</span></span><span class=line><span class=cl>pip                22.3.1
</span></span><span class=line><span class=cl>setuptools         58.1.0
</span></span><span class=line><span class=cl>Werkzeug           2.2.2
</span></span><span class=line><span class=cl>zipp               3.11.0
</span></span></code></pre></td></tr></table></div></div><p>Nothing changes from how you’ve been running your project so far. <code>--app</code> is still set to <code>flaskr</code> and <code>flask run</code> still runs the application, but you can call it from <strong>anywhere</strong>, not just the <code>flask-tutorial</code> directory.</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/digital-garden/notes/python-programming/ data-ctx="Hands on Flask" data-src=/notes/python-programming class=internal-link>Python Programming</a></li><li><a href=/digital-garden/notes/web-development/ data-ctx="Hands on Flask" data-src=/notes/web-development class=internal-link>Web Development</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://yangls06.github.io/digital-garden/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by yangls06 using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://yangls06.github.io/digital-garden/>Home</a></li><li><a href=https://github.com/yangls06>Github</a></li></ul></footer></div></div></body></html>